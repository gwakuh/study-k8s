# 서비스: 클라이언트가 파드를 검색하고 통신을 가능하게 함

## 서비스의 필요성
- 파드는 일시적이다.
  - 다른 파드를 위한 공간 확보를 위해 제거되거나,
  - 누군가 파드 수를 줄이거나,
  - 클러스터 노드의 장애로 다른 노드로 이동될 수 있다.
- 클라이언트가 서버인 파드의 IP 주소를 미리 알 수 없다.
  - 노드에 파드를 스케줄링한 후 파드가 시작되기 전에 파드의 IP 주소를 할당하기 때문에 IP 주소를 미리 알 수 없다.
- 수평 스케일링은 여러 파드가 동일한 서비스를 제공할 수 있음을 의미한다.
  - 클라이언트는 서비스를 지원하는 파드의 수와 IP를 상관하지 않아야 한다.
  - 따라서 클라이언트가 파드의 개별 IP 목록을 유지할 필요가 없다.
  - 즉, 모든 파드가 동일한 IP 주소로 접근할 수 있어야 한다.

## 서비스 소개
- 동일한 서비스를 제공하는 파드 그룹에 지속적인 단일 접점을 만들 때 생성하는 리소스
- 각 서비스는 서비스가 **존재하는 동안 IP 주소와 포트가 절대 바뀌지 않음**
- 클라이언트는 서비스의 IP 주소와 포트로 접속한 다음 해당 서비스의 파드 중 하나로 연결됨
- 클라이언트가 개별 파드의 위치를 알 필요가 없기 때문에, 파드는 언제든지 클러스터 안에서 이동할 수 있음

## 서비스 생성

### kubectl expose로 서비스 생성

### yaml 디스크립터를 통한 서비스 생성
``` kubia-svc.yaml
apiVersion: v1
kind: Service
metadata:
  name: kubia
spec:
  ports:
  - port: 80
    targetPort: 8080
  selector:
    app: kubia
```
- kubia 라는 서비스를 정의
- 서비스가 사용할 포트는 80
- 서비스가 컨테이너로 포워드할 포트는 8080
- app=kubia 레이블이 있는 모든 파드가 서비스에 포함
- 이 후 kubectl create을 통해 서비스 생성

### 새 서비스 검사하기
$ kubectl get svc

![$kubectl get svc](images/1.png)